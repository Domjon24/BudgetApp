"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _index=_interopRequireDefault(require("../../../../../../fusioncharts/core/index"));var _doughnut2d=_interopRequireDefault(require("../../../../../../fusioncharts/viz/doughnut2d"));var _line=_interopRequireDefault(require("../../../../../../fusioncharts/viz/line"));var _utitilies=require("../../../../../../../dev-tests/viz/utitilies");_index.default.addDep(_doughnut2d.default);_index.default.addDep(_line.default);describe("Labels inline styles test",(function(){var chartObj,defaultData={chart:{caption:"<span style='stroke:green;'>Sales<br> of Top <u>Brands</u></span>",showlegend:1},data:[{label:"<span style='stroke: lightskyblue;'>LABEL: Sales <br> of Top <u>Brands</u></span>",value:"0",displayValue:"<span style='stroke:orange;'>Sales<br> of Top <u>Brands</u></span>"},{label:"<span style='stroke:orange;'>Sales<br> of Top <u>Brands</u></span>, 42%",value:"42",displayValue:"10<sup>2</sup>, 42%, 50.00%"},{label:"<H<span style='font-size:75%'>2</span>O, 42%, 50.00%, 42%",value:"42",displayValue:"H<sub style='font-size:75%'>2</sub>O, 42%, 50.00%"}]};beforeEach((function(){chartObj=(0,_utitilies.setup)(_index.default,{type:"doughnut2d",renderAt:_utitilies.CONTAINER_ID,width:"600",height:"350",dataFormat:"json",dataSource:defaultData})}));afterEach((function(){chartObj&&!chartObj.disposed&&chartObj.dispose()}));it("Inline styles should be applied on labels even when there is a linebreak",(function(done){chartObj.addEventListener("renderComplete",(function(){var nodeEls=document.querySelectorAll('[class*="legendGroup"] text');defaultData.data.forEach((function(val,index){var label=val.label;var tempDiv=document.createElement("div");tempDiv.innerHTML=label;var lineBreaks=tempDiv.querySelectorAll("br");var spanEl=tempDiv.querySelector("span");var hasStyleAttribute=label.includes("style=");if(!!lineBreaks.length&&!!spanEl&&hasStyleAttribute){var textEl=nodeEls[index];expect(/<br>|<span>|style=/.test(textEl.textContent)).toBe(false);var tspansWithDy=Array.from(textEl.querySelectorAll("tspan[dy]"));expect(tspansWithDy.length===lineBreaks.length).toBe(true);var innerTspans=Array.from(textEl.querySelectorAll("tspan tspan"));var unmatchedStrokeTspans=innerTspans.filter((function(el){return!!el.getAttribute("stroke")})).filter((function(tspan){return tspan.getAttribute("stroke")!==spanEl.style.stroke}));expect(unmatchedStrokeTspans.length).toBe(0)}}));done()}));chartObj.render()}))}));