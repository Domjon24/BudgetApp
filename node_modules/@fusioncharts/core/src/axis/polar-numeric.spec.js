"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _index=_interopRequireDefault(require("../../../fusioncharts/core/index"));var _angulargauge=_interopRequireDefault(require("../../../fusioncharts/viz/angulargauge"));var _ignoreCaseExt=_interopRequireDefault(require("../../../fc-features/src/ignore-case-ext"));var _utitilies=require("../../../../dev-tests/viz/utitilies");var _lib=require("../lib");_index.default.addDep(_angulargauge.default);_index.default.addDep(_ignoreCaseExt.default);var CONTAINER_ID="chart-container";var chartName=_angulargauge.default.getName(),chartID=chartName.toLowerCase(),chart={type:chartID,renderAt:CONTAINER_ID,width:"600",height:"350",dataFormat:"json",dataSource:{}},TRENDLABEL_ID="_trendLabel";describe("AngularGauge trendpoint labels",(function(){var chartObj;chart.dataSource={chart:{animation:"0",theme:"fusion",upperlimit:"175",lowerlimit:"0",showtickvalues:"1",placevaluesinside:"0",majortmheight:"20",majortmthickness:"1",minortmcolor:"#000000",minortmthickness:"1",valuebelowpivot:"1",gaugestartangle:"210",gaugeendangle:"-30",showcolorrange:"0",pivotradius:"20",pivotfillmix:"000000",majortmnumber:"10",minortmnumber:"10",showtickmarks:"1"},dials:{dial:[{value:"21",showvalue:"0",editmode:"0",bordercolor:"000000",bgcolor:"000000",basewidth:"6"}]},trendpoints:{point:[{thickness:"0",valueinside:"0",startvalue:"40",endvalue:"40",displayvalue:"Target Set Speed",color:"#009A76",dashed:"False",usemarker:"1",markerradius:"15"},{showborder:"False",thickness:"0",valueinside:"True",startvalue:"44",endvalue:"44",displayvalue:"Budget Set Speed",color:"#009A76",dashed:"False",usemarker:"1",markerradius:"15"},{showborder:"False",thickness:"0",valueinside:"True",startvalue:"173",endvalue:"173",displayvalue:"Budget Set Speed",color:"#009A76",dashed:"False",usemarker:"1",markerradius:"15"},{showborder:"False",thickness:"0",valueinside:"True",startvalue:"175",endvalue:"175",displayvalue:"Max Set Speed",color:"#009A76",dashed:"False",usemarker:"1",markerradius:"15"}]}};chartObj=(0,_utitilies.setup)(_index.default,chart);beforeEach((function(){chartObj=(0,_utitilies.setup)(_index.default,chart)}));afterEach((function(){chartObj&&!chartObj.disposed&&chartObj.dispose()}));it("Labels should not overlap on y Axis",(function(done){chartObj.addEventListener("renderComplete",(function(){var axis=chartObj.apiInstance._env.scale,axisConfig=axis.config,trendPoints=axisConfig.trendPoints,point=trendPoints&&trendPoints.point,i,j,iLim=point&&point.length,trendLabelElementCheck,isTrendZone,trendPointObj,startValue,endValue,currentY,idStart,labelsObects=[],minDistanceY=10;for(i=0;i<iLim;i++){trendPointObj=trendPoints.point[i];idStart=trendPointObj.startvalue+"_"+trendPointObj.endvalue+"_"+i;startValue=(0,_lib.pluckNumber)(trendPointObj.startvalue,trendPointObj.value);isTrendZone=startValue!==endValue;endValue=(0,_lib.pluckNumber)(trendPointObj.endvalue,startValue);trendLabelElementCheck=axis.getGraphicalElement(idStart+TRENDLABEL_ID);currentY=trendLabelElementCheck.attrs.y;labelsObects.push({startValue:startValue,endValue:endValue,y:currentY})}i=j=labelsObects.length;while(i-- >0){var obj1=labelsObects[i],obj2=void 0;j=labelsObects.length;while(j-- >0){obj2=labelsObects[j];if(i!=j){minDistanceY=Math.min(minDistanceY,Math.abs(obj2.y-obj1.y))}}}expect(minDistanceY).toBeGreaterThanOrEqual(10);done()}));chartObj.render()}))}));